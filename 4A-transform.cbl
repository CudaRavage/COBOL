IDENTIFICATION DIVISION.
PROGRAM-ID. TRANSFORM.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
SELECT INPUT-FILE
ASSIGN TO "INPUT.DAT"
ORGANIZATION IS LINE SEQUENTIAL.
SELECT OUTPUT-FILE
ASSIGN TO "OUTPUT.DAT"
ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD INPUT-FILE.
01 INPUT-RECORD.
05 IN-NAME PIC X(20).
05 IN-AGE  PIC 99.
FD OUTPUT-FILE.
01 OUTPUT-RECORD.
05 OUT-NAME PIC X(20).
05 OUT-AGE  PIC 99.
05 OUT-FLAG PIC X.
WORKING-STORAGE SECTION.
01 EOF-FLAG        PIC X VALUE "N".
01 RECORDS-READ    PIC 9(5) VALUE 0.
01 RECORDS-WRITTEN PIC 9(5) VALUE 0.

PROCEDURE DIVISION.
OPEN INPUT INPUT-FILE
OUTPUT OUTPUT-FILE.
PERFORM UNTIL EOF-FLAG = "Y"
READ INPUT-FILE
AT END
MOVE "Y" TO EOF-FLAG
NOT AT END
ADD 1 TO RECORDS-READ
MOVE IN-NAME TO OUT-NAME
MOVE IN-AGE TO OUT-AGE
IF IN-AGE >= 30
MOVE "Y" TO OUT-FLAG
ELSE 
MOVE "N" TO OUT-FLAG
END-IF
WRITE OUTPUT-RECORD
ADD 1 TO RECORDS-WRITTEN
END-READ
END-PERFORM.
CLOSE INPUT-FILE OUTPUT-FILE.
DISPLAY "READ:    " RECORDS-READ.
DISPLAY "WRITTEN: " RECORDS-WRITTEN.
STOP RUN.
